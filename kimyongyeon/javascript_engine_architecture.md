# 목표

자바스크립트에 동작 원리를 알아내고, 설명할 수 있다. 

# 핵심 키워드

call stack, event que, webapi js-engine, event loop, 실행 컨텍스트

# 자바스크립트 언어 특징

- 웹브라우저에서 동작하는 유일한 프로그래밍 언어
- 자바스크립트 언어는 인터프리터 언어다.
- 자바스크립트 엔진은 인터프리터와 컴파일러의 장점을 결합해 비교적 처리 속도가 느린 인터프리터의 단점을 해결 하였다.
- 모던 브라우저에서는 사용되는 인터프리터는 전통적 컴파일러 언어 처럼 명시적인 컴파일 단계를 거치지는 않지만 복잡한 과정을 거치며 일부 소스코드를 컴파일하고 실행 한다.
- 명령형, 함수형, 프로토타입 기반, 객체지향 프로그래밍을 지원하는 멀티 패러다임 프로그래밍 언어 이다.
- 프로토타입 기반의 객체지향 언어

# 동기

`이 그룹은 호출되는 함수의 작업 완료 여부를 누가 신경쓰느냐가 관심사이다.`

호출되는 함수에게 callback을 전달해서 호출되는 함수의 작업이 완료되면 호출되는 함수가 전달받은 callback을 실행하고, 호출한 함수는 작업 완료 여부를 신경쓰지 않는다면 비동기 

호출하는 함수가 호출되는 함수의 작업 완료 후 return을 기다리거나 호출되는 함수로 부터 바로 return 받더라도 작업 완료 여부를 호출한 함수 스스로 확인하며 신경 쓴다면 동기.

## 단계

### 동기적 실행

동기적으로 코드를 작성하면 각 단계가 순서대로 실행되는 구문들의 절차라고 표현할 수 있다. 

각 단계의 결과는 이전 단계의 결과에 의존하게 된다. 

변수 및 다음에 발생할 상황을 쉽게 파악할 수 있다. 

코드 작성 및 디버깅이 쉽다. 

1단계 → 2단계 → 3단계

### 비동기적 실행

1단계, 2단계, 3단계 작업이 독립적인 작업이라면 어떤 순서로 실행되더라도 상관 없으며, 동시에 종료될 필요도 없다. 

1단계에서 발생한 데이터를 2단계에서 사용할 수 있다고 보장할 수 없다. 

사람들은 각 작업을 순서대로 실행되게 보장되도록 하기 위해 노력했고, 이런 비동기적 함수 구조를 하나로 묶는 체인을 만들기 시작했다. 즉 콜백함수를 중첩시키는 것이다. 이렇게 하면 비동기 호출이 일어나더라도 각 단계의 순서를 보장할 수 있었다.

1단계 ————완료

2단계 ————————-완료

3단계 —완료

# 블로킹 vs 논블로킹

`이 그룹은 호출되는 함수가 바로 return 하느냐 마느냐가 관심사`

호출된 함수가 바로 return해서 호출한 함수에게 제어권을 넘겨주고 호출한 함수가 다른일을 할 수 있는 기회를 줄 수 있으면 non-blocking 

자신의 작업을 모두 마칠 때까지 호출한 함수에게 제어권을 넘겨주지 않고 대기 하게 만든다. blocking  

# JS 엔진 구조도

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e3a8590d-ef0c-4eb8-95dd-ec0e720f1b01/Untitled.png)

# 런타임

setTimeout은 JS엔진에서는 제공하지 않고, 브라우저에서 제공하는 Web APIs 

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4792b839-bd31-4361-90e1-24cf9dec0355/Untitled.png)

# 호출 스택(Call stack)

호출 스택의 각 단계를 스택 프레임(Stack Frame)이라고 한다.

스택 트레이스 (Stack Trace)

```jsx
function multiply(x, y) {
    return x * y;
}
function printSquare(x) {
    var s = multiply(x, x);
    console.log(s);
}
printSquare(5);
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/70485ac5-84a1-4556-87ec-1ad9fa943eb3/Untitled.png)

## 스택 오버플로우

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e8c801ab-40b2-4d8e-9a34-18f3266a34b3/Untitled.png)

함수 호출 횟수가 호출 스택의 최대 허용치르 넘게 되면 브라우저가 아래와 같은 에러 발생

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/96cf7c24-735f-4fff-84fe-2591c0e072f0/Untitled.png)

# 동시성 & 이벤트 루프

호출 스택에 처리 시간이 어마어마하게 오래 걸리는 함수가 있으면 무슨 일이 발생할까요? 예를 들어, 브라우저에서 자바스크립트로 매우 복잡한 이미지 프로세싱 작업을 한다고 합시다. 

호출 스택에서 해당 함수가 실행되는 동안 브라우저는 아무 작업도 못하고 대기 상태가 된다는 겁니다. 

만약 매끄럽고 자연스러운 화면 UI를 가진 앱을 원한다면 위 경우는 문제가 됩니다. 

자 그렇다면 어떻게 페이지 렌더링 동작을 방해하지 않고 브라우저의 응답도 끊지 않으면서 연산량이 많은 코드를 실행할 수 있을까요? 바로 비동기 콜백